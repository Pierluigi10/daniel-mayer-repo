---
import { getLangFromUrl, useTranslations } from "../utils/i18n";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<section id="contact" class="py-16 bg-white">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Title -->
    <div class="lg:text-center mb-16">
      <h2 class="text-3xl font-bold text-gray-900 sm:text-4xl">
        {t("contact.title")}
      </h2>
    </div>

    <!-- Centered Content -->
    <div class="max-w-md lg:mx-auto space-y-8">
      <!-- Contact Information -->
      <div class="flex items-center justify-start lg:justify-center space-x-4">
        <div
          class="flex items-center justify-center w-10 h-10 bg-primary rounded-lg text-white"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 002 2v10a2 2 0 002 2z"
            ></path>
          </svg>
        </div>
        <div class="text-left lg:text-center">
          <h3 class="text-lg font-semibold text-gray-900 mb-1">
            {t("contact.email")}
          </h3>
          <p class="text-gray-600">info@tax-meyer.de</p>
        </div>
      </div>

      <!-- Calendly Embed Area -->
      <div class="p-6 bg-gray-50 rounded-lg text-left lg:text-center">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">
          {t("contact.appointment")}
        </h3>

        <button
          id="calendly-button"
          class="inline-flex items-center justify-center px-6 py-2 bg-primary text-white rounded-md hover:bg-primary-lite transition-colors cursor-pointer lg:mx-auto"
        >
          {t("contact.appointment.button")}
        </button>

        <!-- Calendly Embed -->
        <div id="calendly-embed" class="mt-6 hidden">
          <div
            class="calendly-inline-widget"
            data-url="https://calendly.com/kanzlei-wp-meyer"
            style="min-width:320px; height:630px; width:100%;"
          >
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const button = document.getElementById("calendly-button");
    const embedDiv = document.getElementById("calendly-embed");

    if (!button || !embedDiv) return;

    button.addEventListener("click", () => {
      if (embedDiv.classList.contains("hidden")) {
        embedDiv.classList.remove("hidden");
        button.textContent = "Kalender ausblenden";

        // Load Calendly script if not already loaded
        if (!document.querySelector('script[src*="calendly"]')) {
          const script = document.createElement("script");
          script.src = "https://assets.calendly.com/assets/external/widget.js";
          script.async = true;
          document.head.appendChild(script);
        }
      } else {
        embedDiv.classList.add("hidden");
        button.textContent = "Termin buchen";
      }
    });
  });
</script>
